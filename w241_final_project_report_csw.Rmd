---
title: 'Final Project Report: A Study of the Effects of Personalization on Survey Response Rates'
author: 'Carlos Eduardo Rodriguez, Sean Underwood, Winston Lin'
date: \today
output: pdf_document
header-includes:
    - \usepackage{caption}
---

\captionsetup[table]{labelformat=empty}

```{r}
library(RCurl)
library(data.table)
library(knitr)
```

# 1. Introduction

## Overview of Company and Business Processes



## Problem Statement/Central Question



## Previous Research on Subject



# 2. Experimental Design

## 2.1. Definition of Treatment

### Outcome of Interest



### Estimator for Treatment Effect



### Null and Alternative Hypotheses



## 2.2. Sample Design

### Sampling Method



### Block Design



### Summary Statistics



## 2.3. Assignment of Treatment

### Randomization Method



### Covariate Balance 



## 2.4. Experimental Procedure

### Instrumentation



### Data Collection


# 3. Pilot Study

We also performed a pilot study with help from the datascience@berkeley staff. They were conducting an email survey of the MIDS student body to study engagement with the _Applications in Data Science_ webinar series, and graciously agreed to help us test some of our procedures on this survey.

## 3.1 Pilot Design

The treatment in the pilot survey was roughly the same as in the primary survey, with control paricipants receiving an email with a generic salutation and treatment participants receiving a personalized salutation that included their first name. In order to remain consistent with existing precedent, the exact wording of the email saluatation was slightly different: "Hello Everyone" for control, and "Hello [studen's first name]" for treatment.

One signifcant departure from the primary experiment's design was that we did not use block random assignment for the pilot study. Sex was not included because we did not have easy access to that information, and department was not included because that variable does not apply in this case. This did unfortunately limit our ability to use the pilot as a full dress rehearsal, since it involved significantly less logistic complexity.

# 4. Results & Discussion

--------------------------------
Group         N  Responses  Rate
----------- --- ---------- ----- 
Treatment:  134          6  4.5%

Control:    133          4  3.0%

Total:      267         10  3.7%
--------------------------------


## 4.1. Experiment 1: ATG All-Hands Meeting

```{r}
#csv = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
#dt = data.table(read.csv(textConnection(csv)))
dt.atg=fread('~/Documents/Berkeley/241/Final\ Project/w241-project-csw/rcode/atg_results.csv')
dt.atg[Female == 0, Sex := 'M']
dt.atg[Female == 1, Sex := 'F']
dt.atg[, Y := Responses / N]
```

```{r, results='asis'}
atg.stats = dt.atg[order(Org, Region, Sex, treat), .(Org, Region, Sex, Treat=treat, N)]
kable(atg.stats, digits=2, caption = "ATG Survey Blocks", format = 'pandoc')
```

```{r}
atg.results = dcast(dt.atg, 
                    blocknum + Org + Region + Sex ~ treat, 
                    value.var= c('N', 'Responses', 'Y'))

atg.results = atg.results[, 
                          .(Org, Region, Sex, 
                            'N' = N_0 + N_1, '# Treat' = N_0, '# Control' = N_1, 
                            'Y(0)' = Y_0, 'Y(1)' = Y_1, ATE = Y_1 - Y_0)]

kable(atg.results, digits=2, caption = "ATG Survey Results", format="pandoc")
```

\pagebreak

## 4.2. Experiment 2: PTG All-Hands Meeting


```{r}
dt.ptg=fread('~/Documents/Berkeley/241/Final\ Project/w241-project-csw/rcode/ptg_assignment.csv')
dt.ptg[Female == 0, Sex := 'M']
dt.ptg[Female == 1, Sex := 'F']
dt.ptg = dt.ptg[order(Org, Region, Sex, Treat), .(Org, Region, Sex, Treat, N)]
```

```{r}
kable(dt.ptg, digits=2, caption="PTG Survey Blocks", format="pandoc")
```


## 4.3. Meta-Analysis of Both Experiments



## 4.4. Applications and Future Research



# 6. Conclusion



# 7. Acknowledgements



# Appendices

## A. Examples of Emails for Treatment and Control Groups


## C. R Code for Experiment

### Sample Data



### Anonymization

```{r}

```

### Block Randomization

```{r}

```


### Analysis

```{r}

```
