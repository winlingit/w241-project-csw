getwd()
setwd('/Users/winlin/Desktop/mids-w241-field-experiments/project/rcode/')
dt = data.table(read.csv('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv'))
library(data.table)
dt = data.table(read.csv('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv'))
library(RCurl)
content = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
dt = data.table(read.csv(content))
content = readLines(getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv'))
dt = data.table(read.csv(content))
csv = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
dt = data.table(read.csv(textConnection(csv)))
View(dt)
dtx = dt[rep(seq(.N), N), !'N', with = F]
View(dtx)
by = block]
dtx = dt[rep(seq(.N), N), !'N', with = F]       # expand table to 352 rows
dtx[ , responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = block]
dtx[ , responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = block]
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = block]
dtx = dt[rep(seq(.N), N), !'N', with = F]       # expand table to 352 rows
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = block]
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = blocknum]
dtx = dt[rep(seq(.N), N), Responded := c(rep(1, Responses)), rep(0, .N-Responses), with = F, by = block]       # expand table to 352 rows
dtx = dt[rep(seq(.N), N), Responded := c(rep(1, Responses)), rep(0, .N-Responses)), with = F, by = block]       # expand table to 352 rows
dtx = dt[rep(seq(.N), N), Responded := c(rep(1, Responses), rep(0, .N-Responses)), with = F, by = block]       # expand table to 352 rows
, !'N'
dtx = dt[rep(seq(.N), N), !'N', with = F]       # expand table to 352 rows
max(dtx$Responses)
dtx[,max(Responses), by = block]
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = CollectorId]
dtx[,max(Responses), by = CollectorId]
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = CollectorId]
library(data.table)
library(RCurl)
# read ATG feedback survey results
csv = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
dt = data.table(read.csv(textConnection(csv)))
# recover observations
dtx = dt[rep(seq(.N), N), !'N', with = F]       # expand table to 352 rows
dtx[ , Responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = CollectorId]
View(dtx)
dt$Responses == dtx[ , sum(Responded), by = CollectorId]
dt$Responses == dtx[ , sum(Responded), !'CollectorId', by = CollectorId]
dt$Responses == dtx[ , sum(Responded), by = CollectorId]$Responded
dt$Responses
dtx[ , sum(Responded), by = CollectorId]$Responded
dtx[ , sum(Responded), by = CollectorId]
dt$Responses == dtx[ , sum(Responded), by = CollectorId]$V1
# read data
csv = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
dt = data.table(read.csv(textConnection(csv)))
# recover observations
dtx = dt[rep(seq(.N), N), !'N', with = F]  # expand table to 352 rows
dtx[ , responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = CollectorId]  # add var for responded
dt$Responses == dtx[ , sum(responded), by = CollectorId]$V1 # checksum for each collector
library(data.table)
library(RCurl)
# Analysis of ATG feedback survey results
# read data
csv = getURL('https://raw.githubusercontent.com/winlingit/w241-project-csw/master/rcode/atg_results.csv')
dt = data.table(read.csv(textConnection(csv)))
# recover observations
dtx = dt[rep(seq(.N), N), !'N', with = F]  # expand table to 352 rows
dtx[ , responded := c(rep(1, max(Responses)), rep(0, .N-max(Responses))), by = CollectorId]  # add var for responded
dt$Responses == dtx[ , sum(responded), by = CollectorId]$V1 # checksum for each collector
m1 = lm(responded ~ treat, data = dtx)
summary(m1)
.07312*352
.07312*23
.07312*28
m2 = lm(responded ~ treat + org, data = dtx)
summary(m2)
m2 = lm(responded ~ treat + Org, data = dtx)
summary(m2)
m3 = lm(responded ~ treat + Org + Female, data = dtx)
summary(m3)
sum(dt$Responses)
dt[ , .(sum(Responses/.N), by = treat)]
dt[ , .(sum(Responses)/.N), by = treat)]
dt[ , .(sum(Responses)/.N), by = treat]
dt[ , .(sum(Responses)/sum(N)), by = treat]
dt[ , .(sum(Responses)/sum(N)), by = treat][ , treat[1]-treat[2]] # overall ATE
dt[ , .(y = sum(Responses)/sum(N)), by = treat][ , y[1]-y[2]] # overall ATE
m1 = lm(responded ~ treat, data = dtx)
summary(m1)
dtx = dt[rep(seq(.N), N), !'N', with = F]  # expand table to 352 rows
dtx[ , responded := c(rep(1, max(Responses)), rep(0, .N - max(Responses))), by = CollectorId]  # add var for responded
dt$Responses == dtx[ , sum(responded), by = CollectorId]$V1  # checksums for total responses for each collector
# regression analysis
# treatment only
m1 = lm(responded ~ treat, data = dtx)
summary(m1)
# treatment + org
m2 = lm(responded ~ treat + Org, data = dtx)
summary(m2)
# treatment + org + sex
m3 = lm(responded ~ treat + Org + Female, data = dtx)
summary(m3)
stargazer(m1, m2, m3)
library(stargazer)
stargazer(m1, m2, m3)
stargazer(m1, m2, m3, type='text')
m4 = lm(responded ~ treat + Female*treat, data = dtx)
summary(m4)
m4 = lm(responded ~ treat + Female + Female*treat, data = dtx)
summary(m4)
m5 = lm(responded ~ treat + Org + treat*Org, data = dtx)
summary(m5)
m1 = lm(responded ~ treat, data = dtx)  # treatment only
summary(m1)
m2 = lm(responded ~ treat + Org, data = dtx)  # treatment + org
summary(m2)
m3 = lm(responded ~ treat + Org + Female, data = dtx)  # treatment + org + sex
summary(m3)
# 4. display results
stargazer(m1, m2, m3, type='text')
.073*352
coeff.test(m3)
coef.test(m3)
summary(m3)$coefficients
ci = coeff[2,2] + c(-1,1)*coeff[2,3]
coeff = summary(m3)$coefficients
ci = coeff[2,2] + c(-1,1)*coeff[2,3]
ci
ci = coeff[2,1] + c(-2,2)*coeff[2,2]
ci
